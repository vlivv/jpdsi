<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                template="/templates/main-template.xhtml">

    <ui:define name="title">
        #{txtMovieList.pageTitle}
    </ui:define>

    <ui:define name="content">

        <p:panel header="#{txtMovieList.searchOptions}" toggleable="true" collapsed="true"
                 style="margin-bottom: 1em;">
            <h:form>
                <h:panelGrid columns="2" cellpadding="5">
                    <h:outputLabel value="#{txtMovieList.title}:" />
                    <p:inputText value="#{movieListBB.title}" />

                    <h:outputLabel value="#{txtMovieList.genre}:" />
                    <p:inputText value="#{movieListBB.genre}" />

                    <h:outputLabel value="#{txtMovieList.director}" />
                    <p:inputText value="#{movieListBB.director}" />

                    <p:commandButton value="#{txtMovieList.search}" update="form-table" />
                </h:panelGrid>
            </h:form>
        </p:panel>

        <p:messages />

        <h:form id="form-table" style="margin-bottom:1em;">

            <p:commandButton value="#{txtMovieList.addMovie}"
                             action="#{movieListBB.newMovie()}"
                             style="margin-bottom:1em;"
                             rendered="#{remoteClient.roles.contains('admin')}" />

            <p:dataTable value="#{movieListBB.list}" var="m">

                <p:column headerText="#{txtMovieList.title}">
                    <h:outputText value="#{m.title}" />
                </p:column>

                <p:column headerText="#{txtMovieList.description}">
                    <h:outputText value="#{m.description}" />
                </p:column>

                <p:column headerText="#{txtMovieList.duration}">
                    <h:outputText value="#{m.durationMin}" />
                </p:column>

                <p:column headerText="#{txtMovieList.ageRating}">
                    <h:outputText value="#{m.ageRating}" />
                </p:column>

                <p:column headerText="#{txtMovieList.genre}">
                    <h:outputText value="#{m.genre}" />
                </p:column>

                <p:column headerText="#{txtMovieList.director}">
                    <h:outputText value="#{m.director}" />
                </p:column>

                <p:column headerText="#{txtMovieList.language}">
                    <h:outputText value="#{m.language}" />
                </p:column>

                <p:column headerText="#{txtMovieList.options}"
                          rendered="#{remoteClient.roles.contains('admin')}">

                    <p:commandButton value="#{txtMovieList.edit}"
                                     action="#{movieListBB.editMovie(m)}"
                                      ajax="false" />

                    <p:commandButton value="#{txtMovieList.delete}"
                                     action="#{movieListBB.deleteMovie(m)}"
                                     update="@form"
                                     onclick="return confirm('#{txtMovieList.confirmation}');"/>
                </p:column>

            </p:dataTable>
        </h:form>

    </ui:define>

</ui:composition>

