<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                template="/templates/main-template.xhtml">

    <ui:define name="title">
        Movie list
    </ui:define>

    <ui:define name="content">

        <p:panel header="Search Options" toggleable="true" collapsed="true"
                 style="margin-bottom: 1em;">
            <h:form>
                <h:panelGrid columns="2" cellpadding="5">
                    <h:outputLabel value="Title:" />
                    <p:inputText value="#{movieListBB.title}" />

                    <h:outputLabel value="Genre:" />
                    <p:inputText value="#{movieListBB.genre}" />

                    <h:outputLabel value="Director:" />
                    <p:inputText value="#{movieListBB.director}" />

                    <p:commandButton value="Search" update="form-table" />
                </h:panelGrid>
            </h:form>
        </p:panel>

        <p:messages />

        <h:form id="form-table" style="margin-bottom:1em;">

            <p:commandButton value="Add New Movie"
                             action="#{movieListBB.newMovie()}"
                             style="margin-bottom:1em;"
                             rendered="#{remoteClient.roles.contains('admin')}" />

            <p:dataTable value="#{movieListBB.list}" var="m">

                <p:column headerText="Title">
                    <h:outputText value="#{m.title}" />
                </p:column>

                <p:column headerText="Description">
                    <h:outputText value="#{m.description}" />
                </p:column>

                <p:column headerText="Duration (min)">
                    <h:outputText value="#{m.durationMin}" />
                </p:column>

                <p:column headerText="Age Rating">
                    <h:outputText value="#{m.ageRating}" />
                </p:column>

                <p:column headerText="Genre">
                    <h:outputText value="#{m.genre}" />
                </p:column>

                <p:column headerText="Director">
                    <h:outputText value="#{m.director}" />
                </p:column>

                <p:column headerText="Language">
                    <h:outputText value="#{m.language}" />
                </p:column>

                <p:column headerText="Options"
                          rendered="#{remoteClient.roles.contains('admin')}">

                    <p:commandButton value="Edit"
                                     action="#{movieListBB.editMovie(m)}" />

                    <p:commandButton value="Delete"
                                     action="#{movieListBB.deleteMovie(m)}"
                                     update="@form"
                                     onclick="return confirm('Are you sure?');"/>
                </p:column>

            </p:dataTable>
        </h:form>

    </ui:define>

</ui:composition>

